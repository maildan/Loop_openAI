"""
ì¡°í•©í˜• ì´ë¦„ ìƒì„± ëª¨ë“ˆ
ìŒì ˆì„ ì¡°í•©í•˜ì—¬ ìƒˆë¡œìš´ ì´ì„¸ê³„/íŒíƒ€ì§€ ì´ë¦„ì„ ìƒì„±í•©ë‹ˆë‹¤.
"""

from typing import Final, Literal, TypeAlias, overload
import random
from functools import lru_cache

# íƒ€ì… ë³„ì¹­ ì •ì˜
GenderType: TypeAlias = Literal["male", "female"]
SyllableType: TypeAlias = Literal["prefix", "middle", "suffix"]

# ğŸ’« ì¡°í•©ìš© ìŒì ˆ (ì§„ì§œ ì´ì„¸ê³„ ëŠë‚Œë‚˜ëŠ”)
isekai_syllables: Final[dict[str, tuple[str, ...]]] = {
    "prefix": (
        # ì¼ë³¸ì–´ ëŠë‚Œ
        "ì•„", "ì¹´", "ì‚¬", "íƒ€", "ë‚˜", "í•˜", "ë§ˆ", "ì•¼", "ë¼", "ì™€",
        "í‚¤", "ì‹œ", "ì¹˜", "ë‹ˆ", "íˆ", "ë¯¸", "ë¦¬", "ìœ ", "ì¿ ", "ìŠ¤",
        "ì—", "ì¼€", "ì„¸", "í…Œ", "ë„¤", "í—¤", "ë©”", "ë ˆ", "ì›¨", "ì¸ ",
        "ì˜¤", "ì½”", "ì†Œ", "í† ", "ë…¸", "í˜¸", "ëª¨", "ìš”", "ë¡œ", "ë£¨",
        # ì„œì–‘ì–´ ëŠë‚Œ
        "ì•Œ", "ë²¨", "ì…€", "ë¸", "ì—˜", "í ", "ê²”", "í—¬", "ì´", "ì ¤",
        "ì•„ë¥´", "ë² ë¥´", "ì„¸ë¥´", "ë°ë¥´", "ì—ë¥´", "í˜ë¥´", "ê²Œë¥´", "í—¤ë¥´",
        "ì•„ë¦¬", "ë² ë¦¬", "ì„¸ë¦¬", "ë°ë¦¬", "ì—ë¦¬", "í˜ë¦¬", "ê²Œë¦¬", "í—¤ë¦¬",
        "ì•„ë¡œ", "ë² ë¡œ", "ì„¸ë¡œ", "ë°ë¡œ", "ì—ë¡œ", "í˜ë¡œ", "ê²Œë¡œ", "í—¤ë¡œ",
    ),
    "middle": (
        "ë¯¸", "ë¦¬", "í‹°", "ë‹ˆ", "ë¹„", "í‚¤", "ì‹œ", "í”¼", "íˆ", "ì§€",
        "ë¼", "ë‚˜", "ë§ˆ", "ì‚¬", "ì¹´", "íƒ€", "íŒŒ", "í•˜", "ì•¼", "ì™€",
        "ë£¨", "ëˆ„", "ë¬´", "ìˆ˜", "ì¿ ", "íˆ¬", "í‘¸", "í›„", "ìœ ", "ì£¼",
        "ë ˆ", "ë„¤", "ë©”", "ì„¸", "ì¼€", "í…Œ", "í˜", "í—¤", "ì˜ˆ", "ì œ",
        "ë¡œ", "ë…¸", "ëª¨", "ì†Œ", "ì½”", "í† ", "í¬", "í˜¸", "ìš”", "ì¡°",
        # ì„œì–‘ì–´ ëŠë‚Œ
        "ë€", "ë Œ", "ë¦°", "ë¡ ", "ë£¬", "ë¼", "ë ˆ", "ë¦¬", "ë¡œ", "ë£¨",
        "íƒ„", "í…", "í‹´", "í†¤", "íŠ ", "íƒ€", "í…Œ", "í‹°", "í† ", "íˆ¬",
        "ë‹¨", "ë´", "ë”˜", "ëˆ", "ë‘”", "ë‹¤", "ë°", "ë””", "ë„", "ë‘",
        "ë§Œ", "ë©˜", "ë¯¼", "ëª¬", "ë¬¸", "ë§ˆ", "ë©”", "ë¯¸", "ëª¨", "ë¬´",
        "ì‚°", "ì„¼", "ì‹ ", "ì†", "ìˆœ", "ì‚¬", "ì„¸", "ì‹œ", "ì†Œ", "ìˆ˜",
        "ì”", "ì  ", "ì§„", "ì¡´", "ì¤€", "ì", "ì œ", "ì§€", "ì¡°", "ì£¼",
    ),
    "suffix": (
        # ì—¬ì„±í˜• ì–´ë¯¸
        "ì•„", "ì•¼", "ë‚˜", "ë¼", "ë§ˆ", "ì‚¬", "ì¹´", "íƒ€", "íŒŒ", "í•˜",
        "ì—", "ì˜ˆ", "ë„¤", "ë ˆ", "ë©”", "ì„¸", "ì¼€", "í…Œ", "í˜", "í—¤",
        "ì´", "ì´", "ë‹ˆ", "ë¦¬", "ë¯¸", "ì‹œ", "í‚¤", "í‹°", "í”¼", "íˆ",
        "ì•„ë‚˜", "ì•¼ë‚˜", "ë‚˜ë‚˜", "ë¼ë‚˜", "ë§ˆë‚˜", "ì‚¬ë‚˜", "ì¹´ë‚˜", "íƒ€ë‚˜",
        "ì—ë‚˜", "ì˜ˆë‚˜", "ë„¤ë‚˜", "ë ˆë‚˜", "ë©”ë‚˜", "ì„¸ë‚˜", "ì¼€ë‚˜", "í…Œë‚˜",
        "ì´ë‚˜", "ì´ë‚˜", "ë‹ˆë‚˜", "ë¦¬ë‚˜", "ë¯¸ë‚˜", "ì‹œë‚˜", "í‚¤ë‚˜", "í‹°ë‚˜",
        "ì•„ë¦¬ì•„", "ì•¼ë¦¬ì•„", "ë‚˜ë¦¬ì•„", "ë¼ë¦¬ì•„", "ë§ˆë¦¬ì•„", "ì‚¬ë¦¬ì•„",
        "ì—ë¦¬ì•„", "ì˜ˆë¦¬ì•„", "ë„¤ë¦¬ì•„", "ë ˆë¦¬ì•„", "ë©”ë¦¬ì•„", "ì„¸ë¦¬ì•„",
        "ì´ë¦¬ì•„", "ì´ë¦¬ì•„", "ë‹ˆë¦¬ì•„", "ë¦¬ë¦¬ì•„", "ë¯¸ë¦¬ì•„", "ì‹œë¦¬ì•„",
        # ë‚¨ì„±í˜• ì–´ë¯¸
        "ì˜¤", "ìš”", "ë…¸", "ë¡œ", "ëª¨", "ì†Œ", "ì½”", "í† ", "í¬", "í˜¸",
        "ìš°", "ìœ ", "ëˆ„", "ë£¨", "ë¬´", "ìˆ˜", "ì¿ ", "íˆ¬", "í‘¸", "í›„",
        "ì˜¨", "ìš˜", "ë…¼", "ë¡ ", "ëª¬", "ì†", "ì½˜", "í†¤", "í°", "í˜¼",
        "ìš°ìŠ¤", "ìœ ìŠ¤", "ëˆ„ìŠ¤", "ë£¨ìŠ¤", "ë¬´ìŠ¤", "ìˆ˜ìŠ¤", "ì¿ ìŠ¤", "íˆ¬ìŠ¤",
        "ì˜¤ë¥´", "ìš”ë¥´", "ë…¸ë¥´", "ë¡œë¥´", "ëª¨ë¥´", "ì†Œë¥´", "ì½”ë¥´", "í† ë¥´",
        "ìš°ë¥´", "ìœ ë¥´", "ëˆ„ë¥´", "ë£¨ë¥´", "ë¬´ë¥´", "ìˆ˜ë¥´", "ì¿ ë¥´", "íˆ¬ë¥´",
        "ì˜¤ìŠ¤", "ìš”ìŠ¤", "ë…¸ìŠ¤", "ë¡œìŠ¤", "ëª¨ìŠ¤", "ì†ŒìŠ¤", "ì½”ìŠ¤", "í† ìŠ¤",
        "ìš°ìŠ¤", "ìœ ìŠ¤", "ëˆ„ìŠ¤", "ë£¨ìŠ¤", "ë¬´ìŠ¤", "ìˆ˜ìŠ¤", "ì¿ ìŠ¤", "íˆ¬ìŠ¤",
    ),
}

# ì„±ë³„ì— ë”°ë¥¸ ì ‘ë¯¸ì‚¬ ê·¸ë£¹
female_suffix_indices: Final[tuple[int, ...]] = tuple(range(0, 60))
male_suffix_indices: Final[tuple[int, ...]] = tuple(range(60, 120))

@lru_cache(maxsize=128)
def get_suffix_by_gender(gender: GenderType) -> tuple[str, ...]:
    """ì„±ë³„ì— ë”°ë¥¸ ì ‘ë¯¸ì‚¬ ë°˜í™˜ (ìºì‹±)
    
    Args:
        gender: ì„±ë³„ ("male" ë˜ëŠ” "female")
        
    Returns:
        ì„±ë³„ì— ë§ëŠ” ì ‘ë¯¸ì‚¬ íŠœí”Œ
    """
    all_suffixes = isekai_syllables["suffix"]
    if gender == "female":
        return tuple(all_suffixes[i] for i in female_suffix_indices if i < len(all_suffixes))
    else:
        return tuple(all_suffixes[i] for i in male_suffix_indices if i < len(all_suffixes))

@overload
def generate_composed_name(gender: Literal["male"]) -> str: ...

@overload
def generate_composed_name(gender: Literal["female"]) -> str: ...

@overload
def generate_composed_name(gender: GenderType = "female") -> str: ...

def generate_composed_name(gender: GenderType = "female") -> str:
    """ì¡°í•©í˜• ì´ë¦„ ìƒì„±
    
    Args:
        gender: ì„±ë³„ ("male" ë˜ëŠ” "female")
        
    Returns:
        ìƒì„±ëœ ì¡°í•©í˜• ì´ë¦„
    """
    # ì ‘ë‘ì‚¬ì™€ ì¤‘ê°„ ìŒì ˆì€ ê³µí†µ
    prefix = random.choice(isekai_syllables["prefix"])
    middle = random.choice(isekai_syllables["middle"])
    
    # ì„±ë³„ì— ë”°ë¥¸ ì ‘ë¯¸ì‚¬ ì„ íƒ
    gender_suffixes = get_suffix_by_gender(gender)
    suffix = random.choice(gender_suffixes)
    
    # ìŒì ˆ ì¡°í•©
    name = f"{prefix}{middle}{suffix}"
    
    # íŠ¹ì • íŒ¨í„´ ìˆ˜ì • (ë°œìŒ ìì—°ìŠ¤ëŸ½ê²Œ)
    name = name.replace("ì•„ì•„", "ì•„").replace("ì—ì—", "ì—").replace("ì´ì´", "ì´")
    name = name.replace("ì˜¤ì˜¤", "ì˜¤").replace("ìš°ìš°", "ìš°")
    
    return name 