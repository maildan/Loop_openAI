"""
ìºë¦­í„° í´ë˜ìŠ¤ë³„ ì´ë¦„ ìƒì„± ëª¨ë“ˆ
ë§ˆë²•ì‚¬, ê¸°ì‚¬, ë„ì  ë“± ìºë¦­í„° í´ë˜ìŠ¤ì— íŠ¹í™”ëœ ì´ë¦„ì„ ìƒì„±í•©ë‹ˆë‹¤.
"""

from typing import Final, Literal, TypeAlias, overload
import random

# íƒ€ì… ë³„ì¹­ ì •ì˜
GenderType: TypeAlias = Literal["male", "female"]
ClassType: TypeAlias = Literal[
    "ë§ˆë²•ì‚¬", "ê¸°ì‚¬", "ë„ì ", "ì„±ì§ì", "ìš©ì‚¬", "ì „ì‚¬", "ê¶ìˆ˜", 
    "ì†Œí™˜ì‚¬", "ìš©ê¸°ì‚¬", "ì•”ì‚´ì", "ê´‘ì „ì‚¬", "ì •ë ¹ì‚¬", "ì£¼ìˆ ì‚¬", 
    "ì—°ê¸ˆìˆ ì‚¬", "ìŒìœ ì‹œì¸", "ë¬´í¬"
]

# ğŸ­ ìºë¦­í„° í´ë˜ìŠ¤ë³„ ì´ë¦„ íŒ¨í„´
class_name_patterns: Final[dict[str, tuple[str, ...]]] = {
    "ë§ˆë²•ì‚¬": ("ë¯¸ìŠ¤í‹±", "ì•„ë¥´ì¹´ë‚˜", "ì…€ë ˆìŠ¤í‹°ì•„", "ë£¨ë‚˜ë¦¬ì•„", "ì•„ìŠ¤íŠ¸ë¼", "ì—í…Œë¦¬ì•„"),
    "ê¸°ì‚¬": ("ì•„ë¥´ì¼€ì¸", "ë§¤ì§€ì¹´", "ë©”ë¥¼ë¦°", "ê°„ë‹¬í”„", "ë¯¸ìŠ¤í„°", "ì„¸ì´ì§€"),
    "ë„ì ": ("ì„€ë„ìš°", "ì‹¤í”„", "ë‹ˆì•¼", "ë¡œê·¸", "íŒ¬í…€", "ë¯¸ìŠ¤íŠ¸"),
    "ì„±ì§ì": ("ì„¸ë¼í•Œ", "ì—”ì ¤", "í™€ë¦¬", "ë””ë°”ì¸", "ì„¸ì¸íŠ¸", "í”„ë¦¬ìŠ¤í‹°ìŠ¤"),
    "ìš©ì‚¬": ("í—¤ë¡œì¸", "ì±”í”¼ì–¸", "ì„¸ì´ë¹„ì–´", "ë ˆìŠ¤íì–´", "ê°€ë””ì–¸", "í”„ë¡œí…í„°"),
    "ì „ì‚¬": ("ì›Œë¦¬ì–´", "ë²„ì„œì»¤", "íŒ”ë¼ë”˜", "ë‚˜ì´íŠ¸", "ê°€ë””ì–¸", "ë””íœë”"),
    "ê¶ìˆ˜": ("ì•„ì²˜", "ë ˆì¸ì €", "ìŠ¤ë‚˜ì´í¼", "í—Œí„°", "íŠ¸ë˜ì»¤", "ë§ˆí¬ìŠ¤ë§¨"),
    "ì†Œí™˜ì‚¬": ("ì„œë¨¸ë„ˆ", "ë„¤í¬ë¡œë§¨ì„œ", "ë“œë£¨ì´ë“œ", "ë¹„ìŠ¤íŠ¸ë§ˆìŠ¤í„°", "ì—˜ë ˆë©˜íƒˆë¦¬ìŠ¤íŠ¸"),
    "ìš©ê¸°ì‚¬": ("ë“œë˜ê³¤ë‚˜ì´íŠ¸", "ë“œë˜ê³¤ìŠ¬ë ˆì´ì–´", "ë“œë˜ê³¤ë§ˆìŠ¤í„°", "ë“œë˜ê³¤í…Œì´ë¨¸"),
    "ì•”ì‚´ì": ("ì–´ìŒ”ì‹ ", "ì‰ë„ìš°", "ë‚˜ì´íŠ¸ë¸”ë ˆì´ë“œ", "ë‹Œì", "ìŠ¤í…”ìŠ¤", "ì‹¤ë£¨ì—£"),
    "ê´‘ì „ì‚¬": ("ë²„ì„œì»¤", "ë ˆì´ì§€", "ë§¤ë“œë‹ˆìŠ¤", "í“¨ë¦¬", "ë¸”ëŸ¬ë“œë ˆì´ì§€", "ë°°í‹€ë§¤ë‹ˆì•…"),
    "ì •ë ¹ì‚¬": ("ì—˜ë ˆë©˜íƒˆë¦¬ìŠ¤íŠ¸", "ìŠ¤í”¼ë¦¿ë§ˆìŠ¤í„°", "ì†Œìš¸ë°”ì¸ë”", "ìŠ¤í”¼ë¦¿ì›Œì»¤"),
    "ì£¼ìˆ ì‚¬": ("ìƒ¤ë¨¼", "ë³´ë‘", "í—¥ì„œ", "ì»¤ì„œ", "ìœ„ì¹˜ë‹¥í„°", "ì˜¤ì»¬í‹°ìŠ¤íŠ¸"),
    "ì—°ê¸ˆìˆ ì‚¬": ("ì•Œì¼€ë¯¸ìŠ¤íŠ¸", "í¬ì…˜ë§ˆìŠ¤í„°", "íŠ¸ëœìŠ¤ë®¤í„°", "ì—˜ë¦­ì„œ", "ë¯¹ì„œ"),
    "ìŒìœ ì‹œì¸": ("ë°”ë“œ", "ì†¡ìŠ¤íŠ¸ë ˆìŠ¤", "í¬ì—£", "ë¼ì´ë¨¸", "ë©œë¡œë””", "í•˜ëª¨ë‹ˆ"),
    "ë¬´í¬": ("ëŒ„ì„œ", "í¼í¬ë¨¸", "ì—”í„°í…Œì´ë„ˆ", "ì•„í¬ë¡œë±ƒ", "ë°œë ˆë¦¬ë‚˜", "ë¦¬ë“¬ë§ˆìŠ¤í„°"),
}

@overload
def generate_by_class(character_class: ClassType, gender: Literal["male"]) -> str: ...

@overload
def generate_by_class(character_class: ClassType, gender: Literal["female"]) -> str: ...

@overload
def generate_by_class(character_class: str, gender: GenderType = "female") -> str: ...

def generate_by_class(character_class: str, gender: GenderType = "female") -> str:
    """í´ë˜ìŠ¤ë³„ íŠ¹í™” ì´ë¦„ ìƒì„±
    
    Args:
        character_class: ìºë¦­í„° í´ë˜ìŠ¤ëª…
        gender: ì„±ë³„ ("male" ë˜ëŠ” "female")
        
    Returns:
        ìƒì„±ëœ í´ë˜ìŠ¤ íŠ¹í™” ì´ë¦„
    """
    from .composed_name import isekai_syllables
    
    if character_class in class_name_patterns:
        base_name = random.choice(class_name_patterns[character_class])

        # ì¡°í•©ìœ¼ë¡œ ë³€í˜•
        if random.random() < 0.3:  # 30% í™•ë¥ ë¡œ ì¡°í•©í˜•ìœ¼ë¡œ ë³€í˜•
            syllable = random.choice(isekai_syllables["middle"])
            return f"{base_name[:2]}{syllable}{base_name[2:]}"

        return base_name
    else:
        # í´ë˜ìŠ¤ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ ì´ë¦„ ìƒì„±
        from .isekai_anime import generate_isekai_anime_name
        # íƒ€ì… ì•ˆì „ì„±ì„ ìœ„í•´ ë¦¬í„°ëŸ´ ë¬¸ìì—´ ì‚¬ìš©
        if gender == "male":
            return generate_isekai_anime_name("male")
        else:
            return generate_isekai_anime_name("female") 